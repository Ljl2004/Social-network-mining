# 使用说明

## 快速开始（3步）

### 步骤1: 安装依赖
```bash
pip install -r requirements.txt
```

### 步骤2: 运行演示程序
```bash
cd src
python demo.py
```
或者在不显示图形窗口的环境中：
```bash
MPLBACKEND=Agg python demo.py
```

### 步骤3: 查看结果
- 可视化图表: `figures/` 目录（6张PNG图片）
- 实验结果: `results/` 目录（CSV数据和实验总结）

---

## 演示程序说明

运行 `demo.py` 将自动完成以下步骤：

### 1. 数据加载与预处理
- 加载NYC Foursquare数据集（227,428条记录）
- 计算用户特征和统计信息
- 保存样本数据

### 2. 数据可视化（生成6张图表）
- `1_temporal_patterns.png` - 时间模式分析
- `2_location_popularity.png` - 地点热度排名
- `3_spatial_distribution.png` - 空间地理分布
- `4_user_activity.png` - 用户活跃度分析
- `5_community_analysis.png` - 社区共现分析
- `6_user_checkin_map.png` - 用户签到地图

### 3. POI推荐演示
展示5种推荐算法：
- 协同过滤推荐
- 基于地理位置的推荐
- 基于时间模式的推荐
- 混合推荐系统
- 下一地点预测

### 4. 推荐系统评估
- 使用留一法交叉验证
- 计算准确率、召回率、F1分数

### 5. 社区分析
- 分析热门地点的访问模式
- 计算社区统计数据

### 6. 生成实验报告
- 自动生成实验总结（`results/实验总结.txt`）

---

## 快速示例程序

如果想快速体验核心功能（不需要完整演示）：

```bash
cd src
python quick_example.py
```

这将：
1. 加载数据
2. 生成2张示例图表
3. 演示推荐功能
4. 预测下一地点

运行时间约1-2分钟。

---

## 主要模块使用

### 1. 数据加载
```python
from data_loader import DataLoader

loader = DataLoader(data_dir='../data')
nyc_data = loader.load_foursquare_data('NYC')

# 计算用户特征
user_features = loader.compute_user_features(nyc_data)
```

### 2. 数据可视化
```python
from visualizer import POIVisualizer

visualizer = POIVisualizer(output_dir='../figures')

# 时间模式分析
visualizer.plot_temporal_patterns(nyc_data, 
                                 save_name='temporal.png')

# 用户签到地图
visualizer.plot_user_checkins_map(nyc_data, 
                                  user_id=470,
                                  save_name='user_map.png')
```

### 3. POI推荐
```python
from recommender import POIRecommender

recommender = POIRecommender(nyc_data)

# 混合推荐
recommendations = recommender.hybrid_recommendation(
    user_id=470,
    current_hour=18,    # 下午6点
    current_day=4,      # 周五
    n_recommendations=10
)

# 下一地点预测
next_locations = recommender.predict_next_location(
    user_id=470,
    n_predictions=5
)
```

---

## 运行时间估计

| 程序 | 数据量 | 预计时间 |
|------|--------|---------|
| demo.py | 完整数据集 | 5-10分钟 |
| quick_example.py | 部分数据 | 1-2分钟 |

*注：时间取决于计算机性能*

---

## 常见问题

### Q1: 如何只生成可视化图表？
```python
# 只运行可视化部分
from data_loader import DataLoader
from visualizer import POIVisualizer

loader = DataLoader()
data = loader.load_foursquare_data('NYC')
visualizer = POIVisualizer()

# 选择需要的可视化
visualizer.plot_temporal_patterns(data.head(20000))
visualizer.plot_spatial_distribution(data.head(20000))
```

### Q2: 如何为特定用户生成推荐？
```python
from data_loader import DataLoader
from recommender import POIRecommender

loader = DataLoader()
data = loader.load_foursquare_data('NYC')
recommender = POIRecommender(data)

# 替换为你想要的用户ID
my_user_id = 470
recs = recommender.hybrid_recommendation(my_user_id)

for loc, score in recs:
    print(f"{loc}: {score:.4f}")
```

### Q3: 如何使用东京数据集？
```python
# 加载TKY数据而不是NYC
tky_data = loader.load_foursquare_data('TKY')
```

### Q4: 如何使用Brightkite数据？
```python
# Brightkite数据很大，建议先采样
brightkite_data = loader.load_brightkite_data(sample_size=100000)
```

### Q5: 图表不显示怎么办？
在服务器或无图形界面环境中：
```bash
# 使用Agg后端（不显示窗口，直接保存）
MPLBACKEND=Agg python demo.py
```

---

## 文件说明

### 源代码
- `data_loader.py` - 数据加载和预处理
- `visualizer.py` - 数据可视化
- `recommender.py` - POI推荐系统
- `demo.py` - 完整演示程序
- `quick_example.py` - 快速示例

### 文档
- `README.md` - 项目说明
- `项目报告.md` - 详细项目报告（包含算法、实验等）
- `交付清单.md` - 项目交付清单
- `使用说明.md` - 本文件

### 配置
- `requirements.txt` - Python依赖包

### 数据（需要自行下载）
- `data/dataset_TSMC2014_NYC.csv` - NYC签到数据
- `data/dataset_TSMC2014_TKY.csv` - 东京签到数据  
- `data/loc-brightkite_totalCheckins.txt` - Brightkite数据

---

## 技术支持

如遇到问题：
1. 检查Python版本（需要3.7+）
2. 确认已安装所有依赖包
3. 查看错误信息
4. 参考项目报告中的详细说明

---

**更新时间**: 2025年12月8日
